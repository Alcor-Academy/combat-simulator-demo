{
  "task_id": "02-01",
  "project_id": "interactive-cli-combat-viewer",
  "execution_agent": "software-crafter",
  "self_contained_context": {
    "background": "Part of Phase 2: Interactive Input with Validation. Outside-In TDD: E2E tests define interactive input behavior before implementation.\nEnsures we build exactly the validation logic users need.\n",
    "prerequisites_completed": [
      "01-06"
    ],
    "relevant_files": [
      "tests/e2e/test_cli_combat.py (modify)",
      "tests/e2e/features/cli_combat.feature (modify)"
    ],
    "technical_context": "Enable acceptance tests for character creation to drive Phase 2 implementation.\n\nTests to enable in tests/e2e/features/cli_combat.feature:\n1. \"User creates both characters with manual input\"\n2. \"User uses random defaults for character attributes\"\n3. \"Invalid HP input triggers validation error and re-prompt\"\n4. \"Invalid attack power input triggers validation error\"\n5. \"Empty name input triggers validation error\"\n\nStep definitions in tests/e2e/test_cli_combat.py:\n- @when('I enter \"{value}\" for character {num} name')\n- @when('I enter \"{value}\" for character {num} HP')\n- @when('I press INVIO for character {num} HP')\n- @then('validation error is displayed in red')\n- @then('error message contains \"{text}\"')\n- @then('I am re-prompted for character {num} {field}')\n- @then('character {num} has name \"{name}\", HP {hp}, attack power {attack}, agility {agility}')\n\nMock input strategy:\n- Use pytest-mock to mock Rich Prompt.ask() and IntPrompt.ask()\n- Provide input sequences including invalid values\n- Verify error messages displayed\n- Verify re-prompting occurs\n\nExample step implementation:\n```python\n@when('I enter \"{value}\" for character 1 HP')\ndef step_enter_hp(context, value, monkeypatch):\n    # Mock Rich IntPrompt to return value\n    inputs = [value]\n    input_iter = iter(inputs)\n    monkeypatch.setattr(\n        \"rich.prompt.IntPrompt.ask\",\n        lambda *args, **kwargs: int(next(input_iter))\n    )\n```\n\nValidation:\n- pytest tests/e2e/test_cli_combat.py -k \"character creation\" -v\n- Tests FAIL initially (CharacterCreator doesn't exist)\n",
    "tdd_phase": "RED",
    "active_e2e_test": "E2E Test #1: Manual Character Creation - SHOULD FAIL (RED)",
    "inactive_e2e_tests": "All E2E tests except the active one should remain disabled with @pytest.mark.skip or similar"
  },
  "task_specification": {
    "name": "Enable E2E Test #1: Manual Character Creation (RED)",
    "description": "ATDD RED Phase: Enable FIRST acceptance test for character creation.\n\n**Test to Enable** (remove @skip):\n- \"User creates both characters with manual input\"\n\n**Step Definitions to Implement** (reusable for all 5 future tests):\n- @when('I enter \"{value}\" for character {num} name')\n- @when('I enter \"{value}\" for character {num} {field}')\n- @when('I press INVIO for character {num} {field}')\n- @then('both characters are created successfully')\n\n**Tests to Keep Disabled** (for future steps):\n- \"User uses random defaults\" → 02-04\n- \"Invalid HP input triggers validation\" → 02-07  \n- \"Invalid attack power triggers validation\" → 02-07\n- \"Empty name triggers validation\" → 02-07\n\nMock Strategy:\n- Use monkeypatch to mock Rich Prompt.ask()\n- Simulate user keyboard input\n- Verify CharacterCreator import attempted\n\nValidation:\n- pytest tests/e2e/test_cli_combat.py::test_manual_input -v\n- Test FAILS (CharacterCreator not implemented - expected RED)\n",
    "motivation": "Outside-In TDD: E2E tests define interactive input behavior before implementation.\nEnsures we build exactly the validation logic users need.\n",
    "commit_policy": "Commit RED phase after test is enabled and failing. Commit message: 'test(e2e): Enable character creation test #1 - RED phase (expected failure)'. This establishes the failing test as a git checkpoint.",
    "detailed_instructions": "ATDD RED Phase: Enable FIRST acceptance test only.\n\n1. Edit tests/e2e/features/cli_combat.feature\n   - Remove @skip from scenario: \"User creates both characters with manual input\"\n   - Keep @skip on all other character creation scenarios (will enable in future steps)\n\n2. Implement reusable step definitions in tests/e2e/test_cli_combat.py:\n   ```python\n   @when('I enter \"{value}\" for character {num} name')\n   def step_enter_name(context, value, num):\n       # Mock Prompt.ask to return value\n       context.inputs.append(value)\n   \n   @when('I enter \"{value}\" for character {num} {field}')\n   def step_enter_field(context, value, num, field):\n       # Generic handler for HP, attack, etc.\n       context.inputs.append(value)\n   \n   @when('I press INVIO for character {num} {field}')\n   def step_press_enter(context, num, field):\n       # Simulate empty input (random default)\n       context.inputs.append(\"\")\n   \n   @then('both characters are created successfully')\n   def step_verify_creation(context):\n       # This will FAIL - CharacterCreator doesn't exist yet\n       from modules.infrastructure.cli.character_creator import CharacterCreator\n       # Assertion will raise ImportError\n   ```\n\n3. Run test to verify RED phase:\n   ```bash\n   pytest tests/e2e/test_cli_combat.py::test_manual_character_input -v\n   ```\n\nExpected: Test FAILS with ImportError or ModuleNotFoundError (CharacterCreator not implemented)\n",
    "acceptance_criteria": [
      "1 E2E test enabled in cli_combat.feature (\"User creates both characters with manual input\")",
      "Step definitions implemented for character input (reusable for future tests)",
      "Mock strategy for Rich Prompt defined",
      "pytest runs test and FAILS (red phase)",
      "Error message indicates missing CharacterCreator"
    ],
    "estimated_hours": 1.0
  },
  "dependencies": {
    "requires": [
      "01-06"
    ],
    "blocking": [
      "02-02"
    ]
  },
  "state": {
    "status": "IN_PROGRESS",
    "assigned_to": "software-crafter",
    "started_at": "2026-01-10T13:30:00Z",
    "completed_at": null,
    "updated": "2026-01-10T15:00:00Z",
    "notes": "E2E test enabled and FAILING (RED phase). Proceeding to 02-02 to implement CharacterCreator. Will mark DONE when test PASSES."
  },
  "execution_result": {
    "summary": "Successfully enabled FIRST E2E test for Phase 2 character creation - FAILING as expected in RED phase (Outside-In TDD: one acceptance test at a time)",
    "test_enabled": "User creates both characters with manual input",
    "tests_prepared_but_disabled": [
      "User uses random defaults for character attributes (will enable after first passes)",
      "Invalid HP input triggers validation error and re-prompt (will enable after second passes)",
      "Invalid attack power input triggers validation error (will enable after third passes)",
      "Empty name input triggers validation error (will enable after fourth passes)"
    ],
    "step_definitions_implemented": [
      "@when('I enter \"{value}\" for character {num} name') - handles empty strings via regex",
      "@when('I enter \"{value}\" for character {num} {field}') - generic input handler",
      "@when('I press INVIO for character {num} {field}') - random defaults",
      "@then('both characters are created successfully') - attempts CharacterCreator import"
    ],
    "test_execution_results": {
      "total_tests": 32,
      "passed": 1,
      "failed": 1,
      "skipped": 30,
      "baseline_test": "PASSED - Phase 1 infrastructure still working",
      "active_character_creation_test": "FAILED - User creates both characters with manual input (expected RED phase)"
    },
    "red_phase_validation": "✓ Single active E2E test FAILS with expected error indicating CharacterCreator module doesn't exist",
    "error_message_observed": "Failed: CharacterCreator not implemented - expected RED phase failure",
    "tdd_workflow": "Outside-In TDD: Enable ONE acceptance test → RED → Inner loop unit TDD → GREEN → Commit → Enable NEXT acceptance test",
    "files_modified": [
      "tests/e2e/features/cli_combat.feature - removed @skip from FIRST scenario only (proper Outside-In TDD)",
      "tests/e2e/test_cli_combat.py - implemented step definitions for character input (supports all 5 tests when enabled)"
    ],
    "next_step": "02-02: Inner loop TDD - Implement CharacterCreator to make FIRST test pass (GREEN)"
  }
}
