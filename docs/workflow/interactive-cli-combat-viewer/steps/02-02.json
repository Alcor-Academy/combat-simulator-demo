{
  "task_id": "02-02",
  "project_id": "interactive-cli-combat-viewer",
  "execution_agent": "software-crafter",
  "self_contained_context": {
    "background": "Part of Phase 2: Interactive Input with Validation. CharacterCreator encapsulates all input validation logic. Rich Prompt integration provides\nprofessional UX. Random defaults use RandomDiceRoller for consistency with combat.\n",
    "prerequisites_completed": [
      "02-01"
    ],
    "relevant_files": [
      "modules/infrastructure/cli/character_creator.py (create)",
      "tests/unit/infrastructure/cli/test_character_creator.py (create)"
    ],
    "technical_context": "Create CharacterCreator for interactive character creation.\n\nFile: modules/infrastructure/cli/character_creator.py\n\nImplementation:\n```python\nfrom rich.prompt import Prompt, IntPrompt\nfrom rich.panel import Panel\nfrom modules.infrastructure.cli.console_output import ConsoleOutput\nfrom modules.domain.model.character import Character\nfrom modules.infrastructure.random_dice_roller import RandomDiceRoller\n\nclass CharacterCreator:\n    \"\"\"Handles interactive character creation via Rich prompts.\"\"\"\n\n    def __init__(self, console: ConsoleOutput, dice_roller: RandomDiceRoller):\n        self._console = console\n        self._dice_roller = dice_roller\n\n    def create_character(self, character_number: int) -> Character:\n        \"\"\"Create character through interactive prompts.\"\"\"\n        self._console.print(f\"\\n--- Create Character {character_number} ---\")\n\n        # Name prompt (required, no default)\n        while True:\n            name = Prompt.ask(f\"Nome personaggio {character_number}\")\n            name = name.strip()\n            if name:\n                break\n            else:\n                self._console.print(\"‚ùå Name cannot be empty. Please enter a name.\", style=\"red\")\n\n        # HP prompt (with random default)\n        hp = self._prompt_int_with_default(\n            prompt=f\"HP [1-999, INVIO=random 20-80]\",\n            min_val=1,\n            max_val=999,\n            default_generator=self._random_hp,\n            field_name=\"HP\"\n        )\n\n        # Attack power prompt (with random default)\n        attack = self._prompt_int_with_default(\n            prompt=f\"Potere d'attacco [1-99, INVIO=random 5-15]\",\n            min_val=1,\n            max_val=99,\n            default_generator=self._random_attack,\n            field_name=\"Attack power\"\n        )\n\n        # Create Character domain object\n        try:\n            character = Character(name, hp, attack)\n        except ValueError as e:\n            self._console.print(f\"‚ùå Invalid character: {e}\", style=\"red\")\n            return self.create_character(character_number)  # Retry\n\n        # Display character confirmation\n        self._display_character_card(character)\n\n        return character\n\n    def _prompt_int_with_default(self, prompt: str, min_val: int, max_val: int,\n                                 default_generator, field_name: str) -> int:\n        \"\"\"Prompt for integer with validation and random default.\"\"\"\n        while True:\n            value_str = Prompt.ask(prompt, default=\"\")\n\n            # Empty input ‚Üí random default\n            if value_str == \"\":\n                value = default_generator()\n                self._console.print(f\"  ‚Üí Random {field_name}: {value}\", style=\"dim\")\n                return value\n\n            # Validate integer\n            try:\n                value = int(value_str)\n            except ValueError:\n                self._console.print(f\"‚ùå {field_name} must be a whole number. Please try again.\", style=\"red\")\n                continue\n\n            # Validate range\n            if min_val <= value <= max_val:\n                return value\n            else:\n                self._console.print(\n                    f\"‚ùå {field_name} must be between {min_val} and {max_val}. Please try again.\",\n                    style=\"red\"\n                )\n\n    def _random_hp(self) -> int:\n        \"\"\"Generate random HP [20-80] using dice roller.\"\"\"\n        # Simulate 10d6+20 for HP range [20-80]\n        total = sum(self._dice_roller.roll() for _ in range(10))\n        return 20 + total\n\n    def _random_attack(self) -> int:\n        \"\"\"Generate random attack [5-15] using dice roller.\"\"\"\n        # Simulate 2d6+4 for attack range [5-15]\n        total = sum(self._dice_roller.roll() for _ in range(2))\n        return 4 + total\n\n    def _display_character_card(self, character: Character) -> None:\n        \"\"\"Display character summary card.\"\"\"\n        card_text = f\"üßô {character.name}\\n‚ù§Ô∏è  HP: {character.hp}\\n‚öîÔ∏è  Attack: {character.attack_power}\\n‚ö° Agility: {character.agility}\"\n\n        panel = Panel(card_text, title=\"Character Created\", border_style=\"green\")\n        self._console._console.print(panel)  # Access Rich Console directly for Panel\n```\n\nUnit tests:\n- File: tests/unit/infrastructure/cli/test_character_creator.py\n- Test: test_create_character_with_manual_input()\n- Test: test_create_character_with_random_hp()\n- Test: test_create_character_with_random_attack()\n- Test: test_invalid_name_triggers_error()\n- Test: test_invalid_hp_triggers_error()\n- Test: test_invalid_attack_triggers_error()\n- Test: test_random_hp_range()\n- Test: test_random_attack_range()\n- Test: test_dice_roller_returns_valid_range()  # Verify RandomDiceRoller.roll() returns [1-6]\n\nValidation:\n- pytest tests/unit/infrastructure/cli/test_character_creator.py -v\n- All unit tests PASS (8 tests minimum)\n",
    "tdd_phase": "GREEN",
    "active_e2e_test": "E2E Tests 2.1-2.3 (Character Creation) - should PASS when complete",
    "inactive_e2e_tests": "All E2E tests except the active one should remain disabled with @pytest.mark.skip or similar"
  },
  "task_specification": {
    "name": "Implement CharacterCreator with Rich Prompts",
    "description": "Create CharacterCreator for interactive character creation.\n\nFile: modules/infrastructure/cli/character_creator.py\n\nImplementation:\n```python\nfrom rich.prompt import Prompt, IntPrompt\nfrom rich.panel import Panel\nfrom modules.infrastructure.cli.console_output import ConsoleOutput\nfrom modules.domain.model.character import Character\nfrom modules.infrastructure.random_dice_roller import RandomDiceRoller\n\nclass CharacterCreator:\n    \"\"\"Handles interactive character creation via Rich prompts.\"\"\"\n\n    def __init__(self, console: ConsoleOutput, dice_roller: RandomDiceRoller):\n        self._console = console\n        self._dice_roller = dice_roller\n\n    def create_character(self, character_number: int) -> Character:\n        \"\"\"Create character through interactive prompts.\"\"\"\n        self._console.print(f\"\\n--- Create Character {character_number} ---\")\n\n        # Name prompt (required, no default)\n        while True:\n            name = Prompt.ask(f\"Nome personaggio {character_number}\")\n            name = name.strip()\n            if name:\n                break\n            else:\n                self._console.print(\"‚ùå Name cannot be empty. Please enter a name.\", style=\"red\")\n\n        # HP prompt (with random default)\n        hp = self._prompt_int_with_default(\n            prompt=f\"HP [1-999, INVIO=random 20-80]\",\n            min_val=1,\n            max_val=999,\n            default_generator=self._random_hp,\n            field_name=\"HP\"\n        )\n\n        # Attack power prompt (with random default)\n        attack = self._prompt_int_with_default(\n            prompt=f\"Potere d'attacco [1-99, INVIO=random 5-15]\",\n            min_val=1,\n            max_val=99,\n            default_generator=self._random_attack,\n            field_name=\"Attack power\"\n        )\n\n        # Create Character domain object\n        try:\n            character = Character(name, hp, attack)\n        except ValueError as e:\n            self._console.print(f\"‚ùå Invalid character: {e}\", style=\"red\")\n            return self.create_character(character_number)  # Retry\n\n        # Display character confirmation\n        self._display_character_card(character)\n\n        return character\n\n    def _prompt_int_with_default(self, prompt: str, min_val: int, max_val: int,\n                                 default_generator, field_name: str) -> int:\n        \"\"\"Prompt for integer with validation and random default.\"\"\"\n        while True:\n            value_str = Prompt.ask(prompt, default=\"\")\n\n            # Empty input ‚Üí random default\n            if value_str == \"\":\n                value = default_generator()\n                self._console.print(f\"  ‚Üí Random {field_name}: {value}\", style=\"dim\")\n                return value\n\n            # Validate integer\n            try:\n                value = int(value_str)\n            except ValueError:\n                self._console.print(f\"‚ùå {field_name} must be a whole number. Please try again.\", style=\"red\")\n                continue\n\n            # Validate range\n            if min_val <= value <= max_val:\n                return value\n            else:\n                self._console.print(\n                    f\"‚ùå {field_name} must be between {min_val} and {max_val}. Please try again.\",\n                    style=\"red\"\n                )\n\n    def _random_hp(self) -> int:\n        \"\"\"Generate random HP [20-80] using dice roller.\"\"\"\n        # Simulate 10d6+20 for HP range [20-80]\n        total = sum(self._dice_roller.roll() for _ in range(10))\n        return 20 + total\n\n    def _random_attack(self) -> int:\n        \"\"\"Generate random attack [5-15] using dice roller.\"\"\"\n        # Simulate 2d6+4 for attack range [5-15]\n        total = sum(self._dice_roller.roll() for _ in range(2))\n        return 4 + total\n\n    def _display_character_card(self, character: Character) -> None:\n        \"\"\"Display character summary card.\"\"\"\n        card_text = f\"üßô {character.name}\\n‚ù§Ô∏è  HP: {character.hp}\\n‚öîÔ∏è  Attack: {character.attack_power}\\n‚ö° Agility: {character.agility}\"\n\n        panel = Panel(card_text, title=\"Character Created\", border_style=\"green\")\n        self._console._console.print(panel)  # Access Rich Console directly for Panel\n```\n\nUnit tests:\n- File: tests/unit/infrastructure/cli/test_character_creator.py\n- Test: test_create_character_with_manual_input()\n- Test: test_create_character_with_random_hp()\n- Test: test_create_character_with_random_attack()\n- Test: test_invalid_name_triggers_error()\n- Test: test_invalid_hp_triggers_error()\n- Test: test_invalid_attack_triggers_error()\n- Test: test_random_hp_range()\n- Test: test_random_attack_range()\n- Test: test_dice_roller_returns_valid_range()  # Verify RandomDiceRoller.roll() returns [1-6]\n\nValidation:\n- pytest tests/unit/infrastructure/cli/test_character_creator.py -v\n- All unit tests PASS (8 tests minimum)\n",
    "motivation": "CharacterCreator encapsulates all input validation logic. Rich Prompt integration provides\nprofessional UX. Random defaults use RandomDiceRoller for consistency with combat.\n",
    "detailed_instructions": "Create CharacterCreator for interactive character creation.\n\nFile: modules/infrastructure/cli/character_creator.py\n\nImplementation:\n```python\nfrom rich.prompt import Prompt, IntPrompt\nfrom rich.panel import Panel\nfrom modules.infrastructure.cli.console_output import ConsoleOutput\nfrom modules.domain.model.character import Character\nfrom modules.infrastructure.random_dice_roller import RandomDiceRoller\n\nclass CharacterCreator:\n    \"\"\"Handles interactive character creation via Rich prompts.\"\"\"\n\n    def __init__(self, console: ConsoleOutput, dice_roller: RandomDiceRoller):\n        self._console = console\n        self._dice_roller = dice_roller\n\n    def create_character(self, character_number: int) -> Character:\n        \"\"\"Create character through interactive prompts.\"\"\"\n        self._console.print(f\"\\n--- Create Character {character_number} ---\")\n\n        # Name prompt (required, no default)\n        while True:\n            name = Prompt.ask(f\"Nome personaggio {character_number}\")\n            name = name.strip()\n            if name:\n                break\n            else:\n                self._console.print(\"‚ùå Name cannot be empty. Please enter a name.\", style=\"red\")\n\n        # HP prompt (with random default)\n        hp = self._prompt_int_with_default(\n            prompt=f\"HP [1-999, INVIO=random 20-80]\",\n            min_val=1,\n            max_val=999,\n            default_generator=self._random_hp,\n            field_name=\"HP\"\n        )\n\n        # Attack power prompt (with random default)\n        attack = self._prompt_int_with_default(\n            prompt=f\"Potere d'attacco [1-99, INVIO=random 5-15]\",\n            min_val=1,\n            max_val=99,\n            default_generator=self._random_attack,\n            field_name=\"Attack power\"\n        )\n\n        # Create Character domain object\n        try:\n            character = Character(name, hp, attack)\n        except ValueError as e:\n            self._console.print(f\"‚ùå Invalid character: {e}\", style=\"red\")\n            return self.create_character(character_number)  # Retry\n\n        # Display character confirmation\n        self._display_character_card(character)\n\n        return character\n\n    def _prompt_int_with_default(self, prompt: str, min_val: int, max_val: int,\n                                 default_generator, field_name: str) -> int:\n        \"\"\"Prompt for integer with validation and random default.\"\"\"\n        while True:\n            value_str = Prompt.ask(prompt, default=\"\")\n\n            # Empty input ‚Üí random default\n            if value_str == \"\":\n                value = default_generator()\n                self._console.print(f\"  ‚Üí Random {field_name}: {value}\", style=\"dim\")\n                return value\n\n            # Validate integer\n            try:\n                value = int(value_str)\n            except ValueError:\n                self._console.print(f\"‚ùå {field_name} must be a whole number. Please try again.\", style=\"red\")\n                continue\n\n            # Validate range\n            if min_val <= value <= max_val:\n                return value\n            else:\n                self._console.print(\n                    f\"‚ùå {field_name} must be between {min_val} and {max_val}. Please try again.\",\n                    style=\"red\"\n                )\n\n    def _random_hp(self) -> int:\n        \"\"\"Generate random HP [20-80] using dice roller.\"\"\"\n        # Simulate 10d6+20 for HP range [20-80]\n        total = sum(self._dice_roller.roll() for _ in range(10))\n        return 20 + total\n\n    def _random_attack(self) -> int:\n        \"\"\"Generate random attack [5-15] using dice roller.\"\"\"\n        # Simulate 2d6+4 for attack range [5-15]\n        total = sum(self._dice_roller.roll() for _ in range(2))\n        return 4 + total\n\n    def _display_character_card(self, character: Character) -> None:\n        \"\"\"Display character summary card.\"\"\"\n        card_text = f\"üßô {character.name}\\n‚ù§Ô∏è  HP: {character.hp}\\n‚öîÔ∏è  Attack: {character.attack_power}\\n‚ö° Agility: {character.agility}\"\n\n        panel = Panel(card_text, title=\"Character Created\", border_style=\"green\")\n        self._console._console.print(panel)  # Access Rich Console directly for Panel\n```\n\nUnit tests:\n- File: tests/unit/infrastructure/cli/test_character_creator.py\n- Test: test_create_character_with_manual_input()\n- Test: test_create_character_with_random_hp()\n- Test: test_create_character_with_random_attack()\n- Test: test_invalid_name_triggers_error()\n- Test: test_invalid_hp_triggers_error()\n- Test: test_invalid_attack_triggers_error()\n- Test: test_random_hp_range()\n- Test: test_random_attack_range()\n- Test: test_dice_roller_returns_valid_range()  # Verify RandomDiceRoller.roll() returns [1-6]\n\nValidation:\n- pytest tests/unit/infrastructure/cli/test_character_creator.py -v\n- All unit tests PASS (8 tests minimum)\n",
    "acceptance_criteria": [
      "CharacterCreator class exists",
      "create_character() returns Character domain object",
      "Name validation rejects empty input",
      "HP validation enforces range [1-999]",
      "Attack validation enforces range [1-99]",
      "INVIO generates random HP [20-80]",
      "INVIO generates random attack [5-15]",
      "Character confirmation card displayed",
      "Unit tests pass (8 tests minimum)"
    ],
    "estimated_hours": 3.0
  },
  "dependencies": {
    "requires": [
      "02-01"
    ],
    "blocking": [
      "02-03"
    ]
  },
  "state": {
    "status": "TODO",
    "assigned_to": null,
    "started_at": null,
    "completed_at": null,
    "updated": "2026-01-10T12:41:07.248054+00:00"
  }
}
